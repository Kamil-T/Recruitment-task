(this["webpackJsonprecruitment-task"]=this["webpackJsonprecruitment-task"]||[]).push([[0],[,,,,,,function(e,t,n){},,,,,function(e,t,n){e.exports=n(20)},,,,,function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(10),s=n.n(c),i=(n(16),n(1)),o=(n(6),n(4)),l=n.n(o),u=n(8),m=n(7),p=Object(a.createContext)(),f=function(e){var t=Object(a.useState)(null),n=Object(i.a)(t,2),c=n[0],s=n[1],o=Object(a.useState)(!1),f=Object(i.a)(o,2),d=f[0],g=f[1],v=Object(a.useState)(null),b=Object(i.a)(v,2),E=b[0],h=b[1];Object(a.useEffect)((function(){(function(){var e=Object(m.a)(l.a.mark((function e(){var t,n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!0),e.prev=1,e.next=4,fetch("https://recruitment.hal.skygate.io/companies");case 4:return t=e.sent,e.next=7,t.json();case 7:return n=e.sent,e.next=10,Promise.all(n.map(function(){var e=Object(m.a)(l.a.mark((function e(t){var n,a,r,c,s,i,o,m,p,f;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://recruitment.hal.skygate.io/incomes/".concat(t.id));case 2:return n=e.sent,e.next=5,n.json();case 5:return a=e.sent,e.next=8,a.incomes.flatMap((function(e){return[parseFloat(e.value)]}));case 8:return r=e.sent,e.next=11,r.reduce((function(e,t){return e+t}),0);case 11:return c=e.sent,e.next=14,c.toFixed(2);case 14:return s=e.sent,e.next=17,(c/r.length).toFixed(2);case 17:return i=e.sent,e.next=20,new Date;case 20:return o=e.sent,e.next=23,o.getMonth()-1;case 23:return m=e.sent,e.next=26,o.getFullYear();case 26:return p=e.sent,-1===m&&(p=-1,m=11),e.next=30,a.incomes.filter((function(e){var t=new Date(e.date);return t.getFullYear()===p&&t.getMonth()===m})).reduce((function(e,t){return e+parseFloat(t.value)}),0).toFixed(2);case 30:return f=e.sent,e.abrupt("return",Object(u.a)({},a,{totalIncome:parseFloat(s),averageIncome:parseFloat(i),lastMonthIncome:parseFloat(f)}));case 32:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 10:return a=e.sent,e.next=13,Promise.all(a.map((function(e){return Object(u.a)({},n.find((function(t){return t.id===e.id})),{},e)})));case 13:r=e.sent,h(r),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),s(e.t0);case 20:return e.prev=20,g(!1),e.finish(20);case 23:case"end":return e.stop()}}),e,null,[[1,17,20,23]])})));return function(){return e.apply(this,arguments)}})()()}),[]);var k=[E,d,c];return r.a.createElement(p.Provider,{value:k},e.children)},d=n(2),g=(n(18),function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=e,r=[];a<=t;)r.push(a),a+=n;return r}),v="LEFT",b=function(e){var t=e.totalRecords,n=e.pageLimit,a=e.currentPage,c=e.setCurrentPage,s=Math.max(0,Math.min(1,2)),i=Math.ceil(t/n);if(!t||1===i)return null;var o=function(){var e=2*s+3;if(i>e+2){var t=Math.max(2,a-s),n=Math.min(i-1,a+s),r=g(t,n),c=t>2,o=i-n>1,l=e-(r.length+1);switch(!0){case c&&!o:var u=g(t-l,t-1);r=[v].concat(Object(d.a)(u),Object(d.a)(r));break;case!c&&o:var m=g(n+1,n+l);r=[].concat(Object(d.a)(r),Object(d.a)(m),["RIGHT"]);break;case c&&o:default:r=[v].concat(Object(d.a)(r),["RIGHT"])}return[1].concat(Object(d.a)(r),[i])}return g(1,i)}();return r.a.createElement("div",{"aria-label":"Pagination",className:"pagination"},r.a.createElement("span",{className:"pages"},a,"/",i),r.a.createElement("ul",{className:"pages"},o.map((function(e,t){return e===v?r.a.createElement("ul",{key:t,className:"page-item"},r.a.createElement("span",{className:"page-link","aria-label":"Previous",onClick:function(){c(a-1)}},r.a.createElement("span",{"aria-hidden":"true"}," \u2039 "),r.a.createElement("span",{className:"sr-only"}," Previous "))):"RIGHT"===e?r.a.createElement("ul",{key:t,className:"page-item"},r.a.createElement("span",{className:"page-link","aria-label":"Next",onClick:function(){c(a+1)}},r.a.createElement("span",{className:"sr-only"}," Next "),r.a.createElement("span",{"aria-hidden":"true"}," \u203a "))):r.a.createElement("ul",{key:t,className:"page-item ".concat(a===e?"active":"")},r.a.createElement("span",{className:"page-link",onClick:function(){return function(e){c(e)}(e)}},e))}))))},E=(n(19),function(e){var t=e.currentCompanies,n=e.requestSort,a=e.sortConfig,c=e.biggerScreen,s=function(e){if(a)return a.key===e?a.direction:void 0};return r.a.createElement("div",{className:"table"},r.a.createElement("p",{className:"table-item categories"},r.a.createElement("span",{className:s("id"),onClick:function(){return n("id")}},"Id"),r.a.createElement("span",{className:s("name"),onClick:function(){return n("name")}},"Name"),c&&r.a.createElement("span",{className:s("city"),onClick:function(){return n("city")}},"City"),r.a.createElement("span",{className:s("totalIncome"),onClick:function(){return n("totalIncome")}},"Total Inc"),r.a.createElement("span",{className:s("averageIncome"),onClick:function(){return n("averageIncome")}},"Average Inc"),c&&r.a.createElement("span",{className:s("lastMonthIncome"),onClick:function(){return n("lastMonthIncome")}},"Last Month Inc")),t.map((function(e){return r.a.createElement("p",{key:e.id,className:"table-item "},r.a.createElement("span",null,e.id," "),r.a.createElement("span",null,e.name," "),c&&r.a.createElement("span",null,e.city," "),r.a.createElement("span",null,e.totalIncome," "),r.a.createElement("span",null,e.averageIncome," "),c&&r.a.createElement("span",null,e.lastMonthIncome))})))}),h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=Object(a.useState)(t),r=Object(i.a)(n,2),c=r[0],s=r[1],o=Object(a.useMemo)((function(){var t=Object(d.a)(e);return null!==c&&t.sort((function(e,t){var n="string"===typeof e[c.key]?e[c.key].toUpperCase():e[c.key],a="string"===typeof t[c.key]?t[c.key].toUpperCase():t[c.key];return n<a?"ascending"===c.direction?-1:1:n>a?"ascending"===c.direction?1:-1:0})),t}),[e,c]),l=function(e){var t="ascending";c&&c.key===e&&"ascending"===c.direction&&(t="descending"),s({key:e,direction:t})};return{items:o,requestSort:l,sortConfig:c}},k=function(e){var t=e.setFilteredSorted,n=e.companies,c=e.setCurrentPage,s=Object(a.useState)(""),o=Object(i.a)(s,2),l=o[0],u=o[1],m=function(e){var a=e.toLowerCase().trim();if(""===a)t(n);else{var r=n.filter((function(e){return Object.keys(e).some((function(t){return e[t].toString().toLowerCase().includes(a)}))}));t(r),c(1)}};return Object(a.useEffect)((function(){})),r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{className:"filter",type:"text",placeholder:"Type to filter",value:l,onChange:function(e){return t=e.target.value,u(t),void m(t);var t},autoFocus:!0}))},j=function(){var e=Object(a.useContext)(p),t=Object(i.a)(e,1)[0],n=Object(a.useState)(t),c=Object(i.a)(n,2),s=c[0],o=c[1],l=h(s),u=l.items,m=l.requestSort,f=l.sortConfig,d=Object(a.useState)(1),g=Object(i.a)(d,2),v=g[0],j=g[1],O=25*(v-1),y=u.slice(O,O+25),N=Object(a.useState)(window.innerWidth),x=Object(i.a)(N,2),C=x[0],w=x[1],I=C>800;return Object(a.useEffect)((function(){function e(){w(window.innerWidth)}return o(t),window.addEventListener("resize",e),function(t){window.removeEventListener("resize",e)}}),[t]),r.a.createElement(r.a.Fragment,null,!1===I&&r.a.createElement("p",{className:"instructions"},"Try to rotate a screen to see all table categories. Non-visible categories (city, last month income) included in filter"),r.a.createElement("p",{className:"instructions"},"Click on category name to sort"),r.a.createElement("div",{className:"controls"},r.a.createElement(k,{setFilteredSorted:o,companies:t,setCurrentPage:j}),r.a.createElement(b,{totalRecords:u.length,pageLimit:25,currentPage:v,setCurrentPage:j})),r.a.createElement(E,{currentCompanies:y,requestSort:m,sortConfig:f,biggerScreen:I}))};var O=function(){var e=Object(a.useContext)(p),t=Object(i.a)(e,3),n=t[0],c=t[1],s=t[2];return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},c&&r.a.createElement("p",{className:"initial-message"},"Loading..."),s&&r.a.createElement("p",{className:"initial-message"},"Something went wrong..."),n&&r.a.createElement(j,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(f,null,r.a.createElement(O,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[11,1,2]]]);
//# sourceMappingURL=main.5c083733.chunk.js.map